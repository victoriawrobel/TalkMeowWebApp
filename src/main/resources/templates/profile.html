<!DOCTYPE html>
<html lang="en" xmlns:th="http://www.thymeleaf.org">
<style>
    .edit-button {
        cursor: pointer;
        border: none;
        background: none;
        color: blue;
        text-decoration: underline;
    }
</style>
<script>
    function enableEditing() {
        document.getElementById('usernameInput').disabled = false;
        document.getElementById('submitButton').style.display = 'inline';
        document.getElementById('passwordEncrypted').style.display = 'none';
        document.getElementById('passwordChange').style.display = 'inline';
    }

    function validateForm() {
        const username = document.getElementById('usernameInput').value;
        if (username === '') {
            alert('Username cannot be empty');
            return false;
        }
        return true;
    }
</script>
</head>
<body>
<form th:action="@{/profile/change}" method="post" th:object="${currentUser}" onsubmit="return validateForm()">
    <p>E-mail:
        <label for="emailInput"></label><input type="text" id="emailInput" name="email" th:value="${currentUser.getEmail()}" disabled>
        <button type="button" class="edit-button" onclick="enableEditing()">&#9998;</button> <!-- Pencil icon -->
    </p>
    <!-- Placeholder for avatar -->
    <p>Username:
        <label for="usernameInput"></label><input type="text" id="usernameInput" name="username" th:value="${currentUser.getUsername()}" disabled>
    </p>
    <div id="passwordEncrypted" >
        <p>Password: ************</p>
    </div>
    <div id="passwordChange" style="display:none;">
        <p>Password:</p>
        <label for="oldPasswordInput"></label><input type="password" id="oldPasswordInput" name="oldPassword" placeholder="Old password"> <br>
        <label for="newPasswordInput"></label><input type="password" id="newPasswordInput" name="newPassword" placeholder="New password"> <br>
    </div>

    <input type="submit" id="submitButton" value="Submit" style="display:none;">
</form>

<p th:if="${errorMessage}" style="color: red;" th:text="${errorMessage}"></p> <!-- Error message -->
</body>
</html>