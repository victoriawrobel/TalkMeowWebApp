<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title th:text="#{app.name} + ' - Home'"></title>
    <th:block th:insert="~{fragments/header :: header}"></th:block>
</head>
<body>
    <th:block th:insert="~{fragments/new-message-notification :: new-message-notification}"></th:block>
    <nav th:insert="~{fragments/navbar :: navbar}"></nav>
    <div>
        <!-- Home page for logged-in users-->
        <div class="grid-container" th:if="${isLoggedIn && user != null}">
            <h2>Welcome, <span th:text="${user.username}"></span>!</h2>

            <div class="home-main-container">
                <div class="grid-item">
                    <img src="/images/WelcomeCatTransparent.png" alt="Welcome Cat" width="350" height="350">
                </div>
                <div class="grid-item">
                    <div class="grid-item-buttons">
                        <a href="/api/messages/conversation/all" class="button">All Conversations</a>
                        <a href="/profile" class="button">User Profile</a>
                        <a href="/logout" class="button">Logout</a>
                    </div>
                </div>
            </div>
        </div>
        <!-- Home page for non-logged-in users-->
        <div class="container" th:if="${!isLoggedIn || user == null}">
            <img src="/images/TalkMeowLogoTransparent.png" alt="Talk Meow Logo" width="300" height="300">
            <h1>Talk Meow</h1>
            <a href="/register/form" class="button">Register</a>
            <a href="/login/form" class="button">Login</a>
        </div>

        <div id="paw-prints-container"></div>

        <script>
            let pawPrints = [];
            const pawPrintSpacing = 75;
            const animationDuration = 12000; // Duration of the animation in milliseconds
            const waveDelay = 1500;

            function createPawPrints() {
                const container = document.getElementById('paw-prints-container');
                container.innerHTML = ''; // Clear existing paw prints
                pawPrints = [];

                const containerWidth = container.offsetWidth;
                const totalPawPrints = Math.floor(containerWidth / pawPrintSpacing);
                const excessSpace = containerWidth - (totalPawPrints * pawPrintSpacing);
                const leftPadding = excessSpace / 2;
                let rotateUp = true;

                for (let i = 0; i < totalPawPrints; i++) {
                    const pawPrint = document.createElement('img');
                    pawPrint.src = '/images/PawPrintCartoonStyleTransparent.png';
                    pawPrint.className = 'paw-print';
                    pawPrint.style.left = (leftPadding + i * pawPrintSpacing) + 'px';

                    if(rotateUp) {
                        pawPrint.classList.add('rotate-up');
                    } else {
                        pawPrint.classList.add('rotate-down');
                    }

                    rotateUp = !rotateUp;
                    container.appendChild(pawPrint);
                    pawPrints.push(pawPrint);
                }
                animatePawPrints();
            }

            function animatePawPrints() {
                pawPrints.forEach((pawPrint, index) => {
                    const delay = index * waveDelay;

                    pawPrint.style.animation = `fadeInOut ${animationDuration}ms linear ${delay}ms infinite`;
                });
            }

            function onResize() {
                createPawPrints();
            }

            window.addEventListener('resize', onResize);
            window.addEventListener('load', () => {
                createPawPrints();
                animatePawPrints();
            });
        </script>

    </div>
</body>
</html>